<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Additional functionality for more advanced users
">
<title>psrc.travelsurvey tips &amp; tricks • psrc.travelsurvey</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="psrc.travelsurvey tips &amp; tricks">
<meta property="og:description" content="Additional functionality for more advanced users
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">psrc.travelsurvey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calculate_hhts_summaries.html">Calculate Household Travel Survey summaries</a>
    <a class="dropdown-item" href="../articles/psrc.travelsurvey_tips_and_tricks.html">psrc.travelsurvey tips &amp; tricks</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="psrc.travelsurvey_tips_and_tricks_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>psrc.travelsurvey tips &amp; tricks</h1>
            
      
      
      <div class="d-none name"><code>psrc.travelsurvey_tips_and_tricks.Rmd</code></div>
    </div>

    
    
<p>This page describes additional features of the <strong>psrc.travelsurvey</strong> package that are less commonly used, but helpful for specific tasks. If you have ideas regarding functionality you’d like to see implemented in the package, please contact one of the authors; it might wind up on this page later. 8^)</p>
<div class="section level3">
<h3 id="variable-transformation-and-customization">Variable transformation and customization<a class="anchor" aria-label="anchor" href="#variable-transformation-and-customization"></a>
</h3>
<p>The result of the <strong>get_hhts()</strong> function is simply a dataframe, and columns can be added or changed prior to calculating statistics on the object. It is fine to add or change column names and use the new or updated name in the statistical function call.</p>
</div>
<div class="section level3">
<h3 id="bulk-statistic-function">Bulk statistic function<a class="anchor" aria-label="anchor" href="#bulk-statistic-function"></a>
</h3>
<p>The <strong>hhts_bulk_stat()</strong> function is designed for circumstances that ask for repeated analysis of the same year &amp; level, using various grouping variables. In place of a group_var parameter (string or character vector), it accepts group_var_list, i.e. a list in which each element is a grouping variable you want analyzed separately. There is still only one numeric target_var and one stat_type (count, sum, median, or mean), but the function can be used with lapply() for more complicated batch jobs. A key feature is that this function stores the name of the grouping variable as a column in the combined statistics table.</p>
<p>This feature can be expanded to cases with multiple grouping variables, but if so, each element of the list must have the same length and only the first variable can differ across entries. (Note that although the standard statistical functions can have any number of grouping variable combinations, sample sizes generally support only two grouping variables.)</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"res_factors_30min"</span>,
           <span class="st">"res_factors_afford"</span>,
           <span class="st">"res_factors_closefam"</span>,
           <span class="st">"res_factors_hwy"</span>,
           <span class="st">"res_factors_school"</span>,
           <span class="st">"res_factors_space"</span>,
           <span class="st">"res_factors_transit"</span>,
           <span class="st">"res_factors_walk"</span>,
           <span class="st">"res_factors_cultural"</span><span class="op">)</span>
<span class="va">h_2017_19c</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_hhts.html">get_hhts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2017</span>,<span class="fl">2019</span><span class="op">)</span>, <span class="st">"h"</span>, <span class="va">gvars</span><span class="op">)</span>
<span class="va">rs_res_ftrs</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hhts_bulk_stat.html">hhts_bulk_stat</a></span><span class="op">(</span><span class="va">h_2017_19c</span>, <span class="st">"count"</span>, group_var_list<span class="op">=</span><span class="st">"gvars"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="option-to-exclude-na">Option to exclude <code>NA</code><a class="anchor" aria-label="anchor" href="#option-to-exclude-na"></a>
</h3>
<p>Responses can legitimately be missing (<code>NA</code>), which is standard for certain questions (e.g. skip logic, or children, for whom not all data is collected). <code>NA</code> values are removed from the <code>stat_var</code> when calculating sum, median or mean, but by default they are left as a legitimate response category in grouping variables. To exclude <code>NA</code> from grouped result sets, use the option <code>incl_na=FALSE</code> in any psrc.travelsurvey stat function. However, if you do this be aware the resulting totals and shares will no longer match regional totals, representing instead a subset that corresponds with filled responses.</p>
</div>
<div class="section level3">
<h3 id="option-to-specify-a-non-default-survey-expansion-weight">Option to specify a non-default survey expansion weight<a class="anchor" aria-label="anchor" href="#option-to-specify-a-non-default-survey-expansion-weight"></a>
</h3>
<p>For those familiar with the expansion weights who want to determine the weight rather than follow the standard weight hierarchy, you will need to specify the weight name in the <strong>vars</strong> argument of <strong>get_hhts()</strong>, then use the <code>swgt=</code> option in each summary statistical call where that weight is wanted. You can use the same dataframe and switch between weights if you like, as the standard weight will be retrieved by default and will still be used in any statistical call without the <code>swgt=</code> option specified.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Craig Helmann, Christy Lam, Suzanne Childress, Michael Jensen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
